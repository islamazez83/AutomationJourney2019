package AutomationJourney2019.WEBSites.Tests;

import org.testng.annotations.Test;
import org.testng.internal.TestResult;
import org.testng.annotations.BeforeMethod;

import java.awt.List;
import java.net.URI;
import java.net.URL;
import java.sql.Time;
import java.time.Year;
import java.time.YearMonth;
import java.util.Date;
import java.util.Set;
import java.util.concurrent.TimeUnit;

import javax.swing.JTable;
import javax.swing.table.DefaultTableModel;

import org.openqa.selenium.NoSuchElementException;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.FluentWait;
import org.openqa.selenium.support.ui.Wait;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.AfterSuite;

public class TestBase {
	private static WebDriver driver;
	private static TestResult result;
	private static String browserName;
	private URI[] WebSitesURL = new URI[] { URI.create("www.udemy.com")};


	@Test
	public void f() {
	}
	@BeforeMethod
	public void beforeMethod() {
	}

	@AfterMethod
	public void afterMethod() {
	}

	@AfterSuite
	public void afterSuite() {
	}
	public static WebDriver getDriver() {
		return driver;
	}
	public static void setDriver(WebDriver driver) {
		TestBase.driver = driver;
	}
	public static String getBrowserName() {
		return browserName;
	}
	public static void setBrowserName(String browserName) {
		TestBase.browserName = browserName;
	}

	public static TestResult getResult() {
		return result;
	}
	public static void setResult(TestResult result) {
		TestBase.result = result;
	}

	@SuppressWarnings("deprecation")
	public void waitForElementToBe(final String condition,final WebElement Element) {
		Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
				.withTimeout(10, TimeUnit.SECONDS)
				.pollingEvery(2, TimeUnit.SECONDS)
				.ignoring(NoSuchElementException.class);
		switch (condition) {
		case "invisibilityOf":
			wait.until(ExpectedConditions.invisibilityOf(Element));
			break;
		case "elementToBeClickable":
			wait.until(ExpectedConditions.elementToBeClickable(Element));
			break;
		case "visibilityOf":
			wait.until(ExpectedConditions.visibilityOf(Element));
			break;
		default:
			break;
		}				
	}

	@SuppressWarnings("deprecation")
	public void waitForPageToBeWithTitle(String pageTitle) 
	{
		Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
				.withTimeout(10, TimeUnit.SECONDS)
				.pollingEvery(2, TimeUnit.SECONDS)
				.ignoring(NoSuchElementException.class);
		wait.until(ExpectedConditions.titleContains(pageTitle));
	}
	public static void SwitchBetweenBrowserWindows(int index) {
        Set<String> windowHandles = driver.getWindowHandles();
        if (windowHandles.size()>0) {
			driver.switchTo().window((String)windowHandles.toArray()[index]);
		}
	}
	
	public static JTable drawDataTable (String[] columnsNames, JTable table) {
		if (columnsNames != null && columnsNames.length>0) {
			DefaultTableModel tableModel = new DefaultTableModel();
			for(String columnName : columnsNames){
				   tableModel.addColumn(columnName);
				}
			table.setModel(tableModel);			
		}
		return table;
	}
	@SuppressWarnings("deprecation")
	public String GetTodayShortDate()
    {
		Date currentDate = new Date();
		String TodayShortDate = String.valueOf(currentDate.getYear());
        if (String.valueOf(currentDate.getMonth()).length() == 1)
        {
            TodayShortDate += "0" + String.valueOf(currentDate.getMonth());
        }
        else
        {
            TodayShortDate += String.valueOf(currentDate.getMonth());
        }
        return TodayShortDate;
    }
}
